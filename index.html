<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.6">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;title&gt;MIS Punch Calculator&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>body { font-family: Arial; background: #f4f4f4; padding: 20px; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>textarea { width: 100%; height: 280px; padding: 10px; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>button { padding: 10px 20px; margin-top: 10px; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.result { background: #fff; padding: 15px; margin-top: 20px; }</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;h1&gt;ðŸ“‹ MIS Punch Copy-Paste Tool&lt;/h1&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;textarea id="input" placeholder="Paste MIS data here..."&gt;&lt;/textarea&gt;</p>
<p class="p1">&lt;br&gt;</p>
<p class="p1">&lt;button onclick="calculate()"&gt;Calculate&lt;/button&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;div id="output" class="result"&gt;&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;script&gt;</p>
<p class="p1">function calculate() {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const raw = document.getElementById("input").value.trim();</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const output = document.getElementById("output");</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>output.innerHTML = "";</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if (!raw) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>output.innerHTML = "&lt;p&gt;Please paste data.&lt;/p&gt;";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>return;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const blocks = raw.split(/\n(?=N\d+)/);</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>let totalSeconds = 0;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>let workingDays = 0;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>blocks.forEach(block =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const lines = block.split("\n").map(l =&gt; l.trim()).filter(Boolean);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const date = lines[1];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (block.toLowerCase().includes("absent")) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>output.innerHTML += `&lt;p&gt;&lt;strong&gt;${date}:&lt;/strong&gt; Absent&lt;/p&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>return;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const matches = block.match(/\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}/g);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (!matches || matches.length &lt; 2) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>output.innerHTML += `&lt;p&gt;&lt;strong&gt;${date}:&lt;/strong&gt; Incomplete Punch&lt;/p&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>return;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>let seconds = 0;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>for (let i = 0; i &lt; matches.length - 1; i += 2) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const inTime = new Date(matches[i].replace(" ", "T"));</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const outTime = new Date(matches[i + 1].replace(" ", "T"));</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>seconds += (outTime - inTime) / 1000;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>totalSeconds += seconds;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>workingDays++;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const hrs = Math.floor(seconds / 3600);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const mins = Math.floor((seconds % 3600) / 60);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const secs = Math.floor(seconds % 60);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>output.innerHTML += `&lt;p&gt;&lt;strong&gt;${date}:&lt;/strong&gt; ${hrs}:${String(mins).padStart(2,"0")}:${String(secs).padStart(2,"0")}&lt;/p&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>if (workingDays &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const avg = (totalSeconds / 3600 / workingDays).toFixed(2);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>output.innerHTML += `&lt;hr&gt;&lt;h3&gt;Weekly Average: ${avg} hrs&lt;/h3&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p1">}</p>
<p class="p1">&lt;/script&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
